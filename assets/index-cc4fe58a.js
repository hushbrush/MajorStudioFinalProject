(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var te={grad:.9,turn:360,rad:360/(2*Math.PI)},A=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},y=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=Math.pow(10,t)),Math.round(n*e)/n+0},x=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=1),e>n?n:e>t?e:t},Y=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},H=function(e){return{r:x(e.r,0,255),g:x(e.g,0,255),b:x(e.b,0,255),a:x(e.a)}},z=function(e){return{r:y(e.r),g:y(e.g),b:y(e.b),a:y(e.a,3)}},ne=/^#([0-9a-f]{3,8})$/i,E=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},Q=function(e){var t=e.r,n=e.g,r=e.b,a=e.a,i=Math.max(t,n,r),l=i-Math.min(t,n,r),s=l?i===t?(n-r)/l:i===n?2+(r-t)/l:4+(t-n)/l:0;return{h:60*(s<0?s+6:s),s:i?l/i*100:0,v:i/255*100,a}},K=function(e){var t=e.h,n=e.s,r=e.v,a=e.a;t=t/360*6,n/=100,r/=100;var i=Math.floor(t),l=r*(1-n),s=r*(1-(t-i)*n),o=r*(1-(1-t+i)*n),g=i%6;return{r:255*[r,s,l,l,o,r][g],g:255*[o,r,r,s,l,l][g],b:255*[l,l,o,r,r,s][g],a}},V=function(e){return{h:Y(e.h),s:x(e.s,0,100),l:x(e.l,0,100),a:x(e.a)}},j=function(e){return{h:y(e.h),s:y(e.s),l:y(e.l),a:y(e.a,3)}},q=function(e){return K((n=(t=e).s,{h:t.h,s:(n*=((r=t.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:t.a}));var t,n,r},S=function(e){return{h:(t=Q(e)).h,s:(a=(200-(n=t.s))*(r=t.v)/100)>0&&a<200?n*r/100/(a<=100?a:200-a)*100:0,l:a/2,a:t.a};var t,n,r,a},re=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ae=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ie=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,oe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,T={string:[[function(e){var t=ne.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?y(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?y(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=ie.exec(e)||oe.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:H({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=re.exec(e)||ae.exec(e);if(!t)return null;var n,r,a=V({h:(n=t[1],r=t[2],r===void 0&&(r="deg"),Number(n)*(te[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return q(a)},"hsl"]],object:[[function(e){var t=e.r,n=e.g,r=e.b,a=e.a,i=a===void 0?1:a;return A(t)&&A(n)&&A(r)?H({r:Number(t),g:Number(n),b:Number(r),a:Number(i)}):null},"rgb"],[function(e){var t=e.h,n=e.s,r=e.l,a=e.a,i=a===void 0?1:a;if(!A(t)||!A(n)||!A(r))return null;var l=V({h:Number(t),s:Number(n),l:Number(r),a:Number(i)});return q(l)},"hsl"],[function(e){var t=e.h,n=e.s,r=e.v,a=e.a,i=a===void 0?1:a;if(!A(t)||!A(n)||!A(r))return null;var l=function(s){return{h:Y(s.h),s:x(s.s,0,100),v:x(s.v,0,100),a:x(s.a)}}({h:Number(t),s:Number(n),v:Number(r),a:Number(i)});return K(l)},"hsv"]]},U=function(e,t){for(var n=0;n<t.length;n++){var r=t[n][0](e);if(r)return[r,t[n][1]]}return[null,void 0]},le=function(e){return typeof e=="string"?U(e.trim(),T.string):typeof e=="object"&&e!==null?U(e,T.object):[null,void 0]},F=function(e,t){var n=S(e);return{h:n.h,s:x(n.s+100*t,0,100),l:n.l,a:n.a}},$=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},W=function(e,t){var n=S(e);return{h:n.h,s:n.s,l:x(n.l+100*t,0,100),a:n.a}},O=function(){function e(t){this.parsed=le(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return y($(this.rgba),2)},e.prototype.isDark=function(){return $(this.rgba)<.5},e.prototype.isLight=function(){return $(this.rgba)>=.5},e.prototype.toHex=function(){return t=z(this.rgba),n=t.r,r=t.g,a=t.b,l=(i=t.a)<1?E(y(255*i)):"","#"+E(n)+E(r)+E(a)+l;var t,n,r,a,i,l},e.prototype.toRgb=function(){return z(this.rgba)},e.prototype.toRgbString=function(){return t=z(this.rgba),n=t.r,r=t.g,a=t.b,(i=t.a)<1?"rgba("+n+", "+r+", "+a+", "+i+")":"rgb("+n+", "+r+", "+a+")";var t,n,r,a,i},e.prototype.toHsl=function(){return j(S(this.rgba))},e.prototype.toHslString=function(){return t=j(S(this.rgba)),n=t.h,r=t.s,a=t.l,(i=t.a)<1?"hsla("+n+", "+r+"%, "+a+"%, "+i+")":"hsl("+n+", "+r+"%, "+a+"%)";var t,n,r,a,i},e.prototype.toHsv=function(){return t=Q(this.rgba),{h:y(t.h),s:y(t.s),v:y(t.v),a:y(t.a,3)};var t},e.prototype.invert=function(){return C({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),C(F(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),C(F(this.rgba,-t))},e.prototype.grayscale=function(){return C(F(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),C(W(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),C(W(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?C({r:(n=this.rgba).r,g:n.g,b:n.b,a:t}):y(this.rgba.a,3);var n},e.prototype.hue=function(t){var n=S(this.rgba);return typeof t=="number"?C({h:t,s:n.s,l:n.l,a:n.a}):y(n.h)},e.prototype.isEqual=function(t){return this.toHex()===C(t).toHex()},e}(),C=function(e){return e instanceof O?e:new O(e)},G=[],se=function(e){e.forEach(function(t){G.indexOf(t)<0&&(t(O,T),G.push(t))})};function ce(e,t){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var a in n)r[n[a]]=a;var i={};e.prototype.toName=function(l){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var s,o,g=r[this.toHex()];if(g)return g;if(l!=null&&l.closest){var d=this.toRgb(),c=1/0,h="black";if(!i.length)for(var u in n)i[u]=new e(n[u]).toRgb();for(var p in n){var f=(s=d,o=i[p],Math.pow(s.r-o.r,2)+Math.pow(s.g-o.g,2)+Math.pow(s.b-o.b,2));f<c&&(c=f,h=p)}return h}},t.string.push([function(l){var s=l.toLowerCase(),o=s==="transparent"?"#0000":n[s];return o?new e(o).toRgb():null},"name"])}se([ce]);let D="#f0ead6",I="#FFF",Z="#d1d1d1",v,L,J=[],N=[];async function de(){try{const e=await d3.json("data.json");L=ue(e)}catch(e){console.error("Error loading the JSON data:",e)}}function ue(e){if(!Array.isArray(e))return console.error("Expected an array but received:",e),[];const t=[];return e.forEach(function(n){var i,l,s;let r={title:n.title?n.title:"NA",date:n.date?n.date:"NA",thumbnail:((l=(i=n.thumbnail)==null?void 0:i[0])==null?void 0:l.thumbnail)||"NA",link:n.link||"NA",printer:"NA",depicts:"NA",description:"NA",medium:"NA",dimensions:"NA",place:((s=n.place)==null?void 0:s.toString())||"NA",collection:"NA",topics:n.topic||"NA",color:D};if(n.printer)for(let o=0;o<n.printer.length;o++)n.printer[o].label==="Depicts"&&(r.depicts=r.depicts==="NA"?n.printer[o].content:r.depicts+"; "+n.printer[o].content),n.printer[o].label==="Printer"&&(r.printer=r.printer==="NA"?n.printer[o].content:r.printer+"; "+n.printer[o].content);if(n.description)for(let o=0;o<n.description.length;o++)r.description=r.description==="NA"?n.description[o].content:r.description+"; "+n.description[o].content;if(n.collection)for(let o=0;o<n.collection.length;o++)r.collection=r.collection==="NA"?n.collection[o].content:r.collection+"; "+n.collection[o].content;if(n.mediumDimensions)for(let o=0;o<n.mediumDimensions.length;o++){n.mediumDimensions[o].label==="Medium"&&(r.medium=r.medium==="NA"?n.mediumDimensions[o].content:r.medium+"; "+n.mediumDimensions[o].content),n.mediumDimensions[o].label==="Dimensions"&&(r.dimensions=r.dimensions==="NA"?n.mediumDimensions[o].content:r.dimensions+"; "+n.mediumDimensions[o].content);const g=n.mediumDimensions[0].content.match(/ink\s*\((.*?)\)/i);g&&g[1]&&(r.color=g[1].toLowerCase())}const a=/(\$?\d+(\.\d+)?[c\$]?)/;if(a.test(r.title)){const o=r.title.match(a)[0];if(o.includes("$")){const g=parseFloat(o.replace(/[^\d.-]/g,"")),d=Math.round(g*100);r.orgPrice=d+"c"}else r.orgPrice=o}else if(r.title.includes("cent")){const o=r.title.match(/\d+/);r.orgPrice=o?o[0]+"c":"NA"}else r.orgPrice="NA";if(r.title.includes("plate"))r.ssp="proof plate";else if(r.title.includes("single"))r.ssp=1;else if(r.title.includes("sheet")||r.title.includes("block")||r.title.includes("strip")){const o=r.title.match(/\d+/);if(o){const g=parseInt(o[0]);r.title.includes("strip of")||r.title.includes("block of")||r.title.includes("sheet of")?r.ssp=g:r.ssp="NA"}else r.ssp="NA"}else r.ssp="NA";r.selected=!1,t.push(r)}),t}async function fe(){for(await de(),v=0;v<L.length;v++)J[v]=he(L[v]),N[v]=ge(J[v]),N[v].color&&(N[v].color=ee(N[v].color));B(N[2].allIndices,"#radarChartIntro"),B(N[2].allIndices,"#radarChart"),be(N),ye(N),_(N)}fe();function he(e){var f,m;let t=0,n=0;if(e.description){const b=e.description.toLowerCase();b.includes("mint")?n=50:b.includes("unused")&&(n=25),(b.includes("lightly used")||b.includes("slightly worn"))&&(n=5),b.includes("fancy cancel")&&(n=Math.max(n,10)),(b.includes("proof")||b.includes("reprint"))&&(n=Math.min(n,20)),(b.includes("perf 12")||b.includes("perforation"))&&(n+=5),b.includes("card plate proof")&&(n+=5),n=Math.min(n,50)}t+=n;let r=0;e.ssp==="proof plate"||e.title.includes("rare")||e.description.includes("plate proof")?r=25:e.title.includes("misprint")||e.description.includes("limited edition")||e.title.includes("unique")||e.title.includes("error")||e.title.includes("first issue")?r=20:e.title.includes("commemorative")||e.description.includes("special release")?r=15:e.description.includes("first edition")||e.description.includes("reprint")?r=10:(e.description.includes("common")||e.title.includes("standard"))&&(r=5),t+=r;let a=0;e.medium&&(e.medium.includes("engraving")||e.medium.includes("plate printing")?a=5:e.medium.includes("lithography")||e.medium.includes("intaglio")?a=3:e.medium.includes("woodcut")||e.medium.includes("screen")?a=2:(e.medium.includes("offset")||e.medium.includes("digital"))&&(a=1)),t+=a;let i=0;if(e.topics)for(let b of e.topics)if(b.match(/(Civil War|World War|Revolution|Historic Event|Colonial|Empire|Independence|Liberation|Rebellion|Suffrage|Equality|Socialism|Communism|Holocaust|Genocide|Economic Crisis|Great Depression|Renaissance|Enlightenment|Art Movement|Labor Movement|Globalization|Exploration)/i)){i=20;break}else b.match(/(Spanish Inquisition|French Revolution|Industrial Revolution|Neolithic Revolution|Scientific Revolution|Abolitionism|Feminism|Civil Rights Movement|Environmentalism|Urbanization|Monarchy|Feudalism|Balkanization|Enclosure Movement|Imperialism|Great Migration|Black Plague|Treaty of Versailles|Vietnam War|Prohibition|Civil Rights Act|Suffragette|Social Reform|The New Deal|Post-War Reconstruction|Colonial Resistance|Age of Exploration|Transatlantic Slave Trade|Reformation|Age of Enlightenment|Manifest Destiny|Trail of Tears|American Revolution|Constitutional Convention|Women's Suffrage|Civil Rights Act|Labor Unions|Great Society|Space Race|The New Deal|Watergate|Freedom of Speech|Cold War Espionage)/i)?i=10:b.match(/(Pax Romana|Cold War|Terrorism|Financial Crisis|Gilded Age|Soviet Union|Fascism|Apartheid|Decolonization|Cuban Missile Crisis|Nuclear Arms Race|Arab Spring|Brexit|Climate Change|Information Revolution|Digital Age|Postmodernism)/i)&&(i=5);t+=i;let l=0;if(e.title||e.depicts){const b=[{name:"Lincoln",score:10},{name:"Washington",score:10},{name:"Roosevelt",score:9},{name:"Mandela",score:10},{name:"Gandhi",score:9},{name:"Churchill",score:8},{name:"Obama",score:7},{name:"Kennedy",score:8},{name:"Queen",score:7},{name:"Queen Elizabeth II",score:7},{name:"Napoleon",score:8},{name:"the Great",score:7},{name:"Caesar",score:8},{name:"Einstein",score:10},{name:"Curie",score:10},{name:"Newton",score:10},{name:"Tesla",score:9},{name:"Edison",score:8},{name:"Galilei",score:10},{name:"Vinci",score:10},{name:"Darwin",score:8},{name:"Hawking",score:8},{name:"Turing",score:9},{name:"Goodall",score:7},{name:"Mendel",score:7},{name:"Sagan",score:7},{name:"Carson",score:8},{name:"Shakespeare",score:10},{name:"wain",score:8},{name:"Dickens",score:8},{name:"Homer",score:9},{name:"Dickinson",score:7},{name:"Angelou",score:7},{name:"Gogh",score:9},{name:"Picasso",score:9},{name:"Michelangelo",score:10},{name:"Monet",score:8},{name:"Beethoven",score:9},{name:"Mozart",score:9},{name:"Kahlo",score:8},{name:" Bach",score:9},{name:"Tubman",score:9},{name:"Rosa Parks",score:9},{name:"Frederick Douglass",score:9},{name:"Martin Luther King Jr.",score:10},{name:"Susan B. Anthony",score:8},{name:"Malcolm X",score:8},{name:"Ida B. Wells",score:8},{name:"Sojourner Truth",score:8},{name:"Eleanor Roosevelt",score:8},{name:"Amelia Earhart",score:8},{name:"Neil Armstrong",score:9},{name:"Buzz Aldrin",score:8},{name:"Christopher Columbus",score:8},{name:"Marco Polo",score:7},{name:"Ferdinand Magellan",score:8},{name:"Robert Falcon Scott",score:7},{name:"Charles Lindbergh",score:8},{name:"Sally Ride",score:8},{name:"Jobs",score:7},{name:"Gates",score:7},{name:"Oprah Winfrey",score:7},{name:"Mark Zuckerberg",score:3},{name:"Elon Musk",score:8},{name:"Jeff Bezos",score:6},{name:"Malala Yousafzai",score:8},{name:"Greta Thunberg",score:6},{name:"Serena Williams",score:5},{name:"LeBron",score:5}],M=((f=e.title)==null?void 0:f.toLowerCase())||"",P=((m=e.depicts)==null?void 0:m.toLowerCase())||"";b.forEach(k=>{const w=k.name.toLowerCase();(M.includes(w)||P.includes(w))&&(l=Math.max(l,k.score))})}t+=Math.min(l,10);let s=0;const o=parseFloat(e.orgPrice.replace(/[^\d.-]/g,""));o>=50||o>=1&&e.orgPrice.includes("$")?s=10:o>=10?s=5:s=Math.round(o/10*2),t+=s;let g=0;const d=parseInt(e.date[0].substring(0,4));d<=1800?g=30:d<1900?g=20:d<1950&&(g=10),t+=g;let c=0;e.collection&&e.collection.includes("Scott Catalogue")&&(c+=.5,e.collection.match(/USA \d+/)&&(c+=3),e.collection.includes("USA PR")&&(c+=3.5),e.collection.includes("USA O")&&(c+=4),e.collection.includes("USA J")&&(c+=3.5),e.collection.match(/Scott Catalogue USA (\d{1,3}[A-Z0-9]*)/)&&(c+=3),e.collection.includes("Inverted Jenny")&&(c+=5),e.collection.includes("imperforate")&&(c+=4),e.collection.includes("error")&&(c+=5),e.collection.includes("Airmail")&&(c+=4.5),e.collection.includes("classic")&&(c+=3),e.collection.includes("Scott Catalogue USA 11")&&(c+=5),e.collection.includes("Scott Catalogue USA 143L3")&&(c+=4),e.collection.includes("Scott Catalogue USA 44TC")&&(c+=4),e.collection.includes("Scott Catalogue CSA 6")&&(c+=6),e.collection.includes("Scott Catalogue CSA 7")&&(c+=6.5),e.collection.includes("Scott Catalogue USA 246")&&(c+=4.5),e.collection.includes("Back-of-Book")&&(c+=3.5),e.collection.includes("Revenue")&&(c+=4.5),e.collection.includes("Postal Tax")&&(c+=4),e.collection.includes("Postage Due")&&(c+=3.5),e.collection.includes("Special Printing")&&(c+=4),e.collection.includes("Reprint")&&(c+=3)),t+=c;const h=new Set(["National Bank Note Company","American Bank Note Company","Bureau of Engraving and Printing","Wells Fargo & Co.","Post Office Department","Security Engraving and Printing","Postal Press of New York","U.S. Treasury"]);let u=0;if(e.printer!=="NA"){if(h.has(e.printer))switch(e.printer){case"National Bank Note Company":case"American Bank Note Company":u+=1;break;case"Bureau of Engraving and Printing":case"Wells Fargo & Co.":u+=2;break;case"Security Engraving and Printing":u+=2.5;break;case"Postal Press of New York":u+=2;break;case"U.S. Treasury":u+=3;break;case"Post Office Department":u+=.5;break;case"National Bank Note Company":u+=2;break;case"American Bank Note Company":u+=1.5;break;case"Bureau of Engraving and Printing":u+=1.2;break;case"Wells Fargo & Co.":u+=1;break;case"Post Office Department":u+=.8;break;case"Security Engraving and Printing":u+=.6;break;case"Postal Press of New York":u+=.4;break;case"U.S. Treasury":u+=.2;break}e.medium&&e.medium.includes("engraving")&&(u+=1),e.ssp&&e.ssp==="proof plate"&&(u+=1.5),e.description&&(e.description.includes("plate mark")||e.description.includes("watermark"))&&(u+=1.2)}t+=u,e.index=t;const p={Condition:n,Rarity:r,PrintingTechniques:a,HistoricalEvent:i,FamousFigures:l,Denomination:s,Date:g,Collection:c,Printer:u,FinalIndex:t};return e.allIndices=p,e}function ge(e){return e.index>=70?e.bucket="Very High Value":e.index>=50?e.bucket="High Value":e.index>=20?e.bucket="Moderate Value":e.bucket="Low Value",e}function me(e){const t={};for(v=0;v<e.length;v++){const n=e[v];Object.entries(n.allIndices).forEach(([r,a])=>{t[r]=(t[r]||0)+a})}for(v=0;v<e.length;v++);return Object.entries(t).forEach(n=>{t[n[0]]=n[1]/e.length}),t}function pe(e){if(!e){console.error("Data is undefined. Ensure that the click event is passing the correct data.");return}e.selected=!e.selected;const t=L.filter(n=>n.selected);if(console.log("Selected Stamps:",t),d3.selectAll(".clickable-line").style("stroke-width",n=>n.selected?5:1).style("stroke",n=>n.color?n.color:"black").style("pointer-events","auto"),t.length>0){const n=me(t);B(n,"#radarChart")}else console.log("No stamps selected."),B([],"#radarChart")}function B(e,t){if(d3.select(t).html(""),e){var n={top:100,right:100,bottom:100,left:100},r=400;let a=400,i;t=="#radarChartIntro"?i="#fff":i="#000";const l=d3.select(t).append("svg").attr("width",r+n.left+n.right).attr("height",a+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")"),s={Condition:50,Date:30,Rarity:25,PrintingTechniques:10,HistoricalEvent:20,FamousFigures:10,Denomination:10,Collection:11,Printer:5},o=Object.entries(e).map(([f,m])=>{if(f==="FinalIndex")return null;const b=s[f];return{axis:f,value:m/(b||1),maxValue:b}}).filter(f=>f!==null);o.sort(f=>f.value);const g=Math.min(r,a)/2,d=Math.PI*2/o.length,c=d3.scaleLinear().domain([0,1]).range([0,g]),h=d3.lineRadial().radius(f=>c(f.value)).angle((f,m)=>m*d),u=l.append("g").attr("transform",`translate(${r/2}, ${a/2})`);u.selectAll(".radarPolygon").data([o]).enter().append("path").attr("class","radarPolygon").attr("d",f=>{const m=h(f);return m?m+"Z":null}).style("fill",i).style("fill-opacity",.1).style("stroke",i).style("stroke-opacity",1).style("stroke-width","4px");const p=u.selectAll(".radarAxis").data(o).enter().append("g").attr("class","radarAxis");p.append("line").attr("x1",0).attr("y1",0).attr("x2",(f,m)=>c(1)*Math.cos(m*d-Math.PI/2)).attr("y2",(f,m)=>c(1)*Math.sin(m*d-Math.PI/2)).attr("class","radarLine").style("stroke",i).style("stroke-width","0.2px").style("stroke-opacity","0.8"),p.append("circle").attr("cx",(f,m)=>c(f.value)*Math.cos(m*d-Math.PI/2)).attr("cy",(f,m)=>c(f.value)*Math.sin(m*d-Math.PI/2)).attr("r",4).style("fill",i).style("stroke",i),p.append("text").attr("class","radarLabel").attr("x",(f,m)=>c(1.15)*Math.cos(m*d-Math.PI/2)).attr("y",(f,m)=>c(1.15)*Math.sin(m*d-Math.PI/2)).text(f=>f.axis.replace(/([A-Z])/g," $1")).style("text-anchor","middle").style("fill",i).style("font-size","18px").style("font-weight","bold").style("font-family","meursault-variable, serif").style("font-size","18px").style("font-weight","400")}}function be(e){var t={top:20,right:30,bottom:30,left:60},n=1e3-t.left-t.right,r=750-t.top-t.bottom;const a=d3.select("#barChart").append("svg").attr("width",n+t.left+t.right).attr("height",r+t.top*2+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");var i=d3.scaleBand().domain(["Low Value","Moderate Value","High Value","Very High Value"]).range([0,n]).padding(.2);a.append("g").attr("transform","translate(0,"+r+")").call(d3.axisBottom(i)).selectAll("text").style("font-family","meursault-variable, serif").style("font-size","18px").style("font-weight","600"),a.append("text").attr("x",n/2).attr("y",r+40).attr("text-anchor","middle").style("font-family","meursault-variable, serif").style("font-size","18px").style("font-weight","600").text("Value Today");var l=d3.scaleLinear().domain([0,250]).range([r,0]);a.append("g").call(d3.axisLeft(l)),a.append("text").attr("transform","rotate(-90)").attr("y",0-t.left).attr("x",0-r/2).attr("dy","1em").style("text-anchor","middle").style("font-family","meursault-variable, serif").style("font-size","18px").style("font-weight","600").text("Original Price"),a.selectAll("line").data(e).enter().append("line").attr("class","clickable-line").attr("x1",function(s){return i(s.bucket)}).attr("y1",function(s){return l(s.orgPrice)}).attr("x2",function(s){return(i(s.bucket)||0)+i.bandwidth()}).attr("y2",function(s){return l(s.orgPrice)}).style("stroke",function(s){return s.color?ee(s.color):"#000"}).attr("stroke-width",1).style("pointer-events","auto").on("mouseover",function(s,o){if(o.thumbnail){const d=l(o.orgPrice)-115,c=d+230>r-300?-230/2:10;d3.select(this.parentNode).selectAll(".center-image").remove(),d3.select(this.parentNode).append("image").attr("class","center-image").attr("x",i(o.bucket)-30).attr("y",d).attr("width",230).attr("height",230).attr("href",o.thumbnail).style("opacity",0).style("pointer-events","none").transition().duration(500).ease(d3.easeCubicOut).attr("y",d+c).style("opacity",1)}}).on("mouseout",function(){d3.selectAll(".center-image").remove()}).on("click",function(s,o){pe(o)})}function ye(e){var t={top:50,right:200,bottom:40,left:200},n=1400-t.left-t.right,r=3500-t.top-t.bottom;const a=d3.select("#ParallelChart").append("svg").attr("width",n+t.left+t.right).attr("height",r+t.top+t.bottom).append("g").attr("transform",`translate(${t.left}, ${t.top})`),i=Object.keys(e[0].allIndices),l={};i.forEach(d=>{l[d]=d3.scaleLinear().domain(d3.extent(e,c=>c.allIndices[d]||0)).range([0,n])});const s=d3.scalePoint().domain(i).range([0,r]),o={};function g(){const d=e.filter(c=>i.every(h=>{const u=o[h],p=c.allIndices[h];return!u||p>=u[0]&&p<=u[1]}));X(o,"#doubleRadar"),_(d),a.selectAll(".line").data(d,c=>c.id).join(c=>c.append("path").attr("class","line").attr("d",h=>{const u=i.map((p,f)=>{const m=h.allIndices[p],b=(Math.random()-.5)*50;return m!==void 0&&!isNaN(m)?[l[p](m)+b,s(p)]:null}).filter(p=>p!==null);return d3.line().curve(d3.curveLinear)(u)}).style("fill","none").style("stroke",h=>h.color).style("opacity",1).style("stroke-width",1),c=>c,c=>c.remove()),a.selectAll(".axis").each(function(){this.parentNode.appendChild(this)})}g(),X(o,"#doubleRadar"),R(o),i.forEach(d=>{const c=a.append("g").attr("class","axis").attr("transform",`translate(0, ${s(d)})`);d3.select("#ParallelChart").append("div").attr("id",`${d}Anchor`).style("position","absolute").style("top",`${s(d)+3500}px`).style("left","0").style("width","1px").style("height","1px").style("visibility","hidden"),c.call(d3.axisBottom(l[d])).selectAll("text").style("fill",Z).style("font-family","meursault-variable, serif").style("font-size","18px"),c.append("text").attr("class","axis-label").attr("x",n+80).attr("y",-20).style("text-anchor","left").style("text-align","left").style("fill",Z).style("font-size","18px").style("font-weight","bold").style("font-family","meursault-variable, serif").text(d.replace(/([A-Z][a-z]*)/g,`
$1`).trim()).attr("z-index",10);const h=c.append("g").attr("class","slider").attr("transform","translate(0, 0)"),u=h.append("line").attr("x1",0).attr("x2",n).attr("stroke",D).attr("stroke-width",2),p=h.append("line").attr("x1",0).attr("x2",0).attr("stroke",D).attr("stroke-opacity",.3).attr("stroke-width",2),f=h.append("line").attr("x1",n).attr("x2",n).attr("stroke",D).attr("stroke-opacity",.3).attr("stroke-width",2),m=h.append("circle").attr("cx",0).attr("cy",0).attr("r",10).attr("fill",I).attr("cursor","ew-resize").call(d3.drag().on("drag",function(k){const w=Math.max(0,Math.min(n,k.x));d3.select(this).attr("cx",w),o[d][0]=l[d].invert(w),P.attr("visibility","visible"),M(),g(),R(o)})),b=h.append("circle").attr("cx",n).attr("cy",0).attr("r",10).attr("fill",I).attr("cursor","ew-resize").call(d3.drag().on("drag",function(k){const w=Math.max(0,Math.min(n,k.x));d3.select(this).attr("cx",w),o[d][1]=l[d].invert(w),P.attr("visibility","visible"),M(),g(),R(o)}));o[d]=[l[d].domain()[0],l[d].domain()[1]];function M(){const k=l[d](o[d][0]),w=l[d](o[d][1]);p.attr("x2",k),f.attr("x1",w).attr("x2",n),u.attr("x1",k).attr("x2",w)}let P=c.append("image").attr("visibility","hidden").attr("x",n+30).attr("y",-10).attr("width",30).attr("height",30).attr("xlink:href","finalProject/Assets/reset.svg").style("cursor","pointer").on("click",function(){console.log("Resetting range for",d),o[d]=[l[d].domain()[0],l[d].domain()[1]],P.attr("visibility","hidden"),m.attr("cx",l[d](o[d][0])),b.attr("cx",l[d](o[d][1])),g(),M(),R(o)})})}function X(e,t){const n=Object.keys(e).filter(h=>!h.includes("range")),r=n.map(h=>e[h][0]),a=n.map(h=>e[h][1]);console.log(r,a);const i=70,l=Math.PI*2/n.length,s=d3.select(t).html("").append("svg").attr("width",270).attr("height",1e3).append("g").attr("transform","translate(115, 157)");s.append("text").attr("x",-20).attr("y",-130).attr("text-anchor","middle").attr("dominant-baseline","middle").attr("font-size","18px").attr("font-weight","bold").attr("font-family","meursault-variable, serif").attr("fill",I).text("Current Filter Selection:"),n.forEach((h,u)=>{const p=u*l,f=i*Math.cos(p-Math.PI/2),m=i*Math.sin(p-Math.PI/2);s.append("line").attr("x1",0).attr("y1",0).attr("x2",f).attr("y2",m).style("stroke","#fff").style("stroke-width","0.2px").style("stroke-opacity","0.8"),s.append("text").attr("x",(i+25)*Math.cos(p-Math.PI/2)).attr("y",(i+27)*Math.sin(p-Math.PI/2)).style("text-anchor","middle").style("font-size","12px").style("font-weight","bold").style("font-family","meursault-variable, serif").style("fill",I).text(h.replace(/([A-Z])/g," $1"))});const o={Condition:50,Date:30,Rarity:25,PrintingTechniques:5,HistoricalEvent:20,FamousFigures:10,Denomination:10,Collection:11,Printer:4,FinalIndex:129};function g(h){return h.map((u,p)=>{const f=p*l,m=n[p],b=o[m];if(!b)return console.error(`Max value not defined for dimension: ${m}`),[0,0];const M=u/b*i,P=M*Math.cos(f-Math.PI/2),k=M*Math.sin(f-Math.PI/2);return[P,k]})}const d=g(r),c=g(a);d.forEach((h,u)=>{const p=c[u];s.append("line").attr("x1",h[0]).attr("y1",h[1]).attr("x2",p[0]).attr("y2",p[1]).style("stroke",I).style("stroke-width",2),s.append("circle").attr("cx",h[0]).attr("cy",h[1]).attr("r",2).style("fill",I),s.append("circle").attr("cx",p[0]).attr("cy",p[1]).attr("r",2).style("fill",I)})}function R(e){const t=document.getElementById("textBlock");let n=`
        <h3> These are all the stamps that fall in the following criteria: <br> <br>
    `;Object.keys(e).forEach(r=>{const a=e[r],l=ve(r.replace("Range","")).replace(/([A-Z])/g," $1");n+=`
            <a href="#${r.replace("Range","")}Anchor" 
               style="text-decoration: none; color: inherit;" 
               onclick="scrollToAnchor('${r.replace("Range","")}Anchor')">
               ${l}: ${Math.floor(a[0])} and ${Math.floor(a[1])}
            </a> <br>`}),n+="</h3>",t.innerHTML=n}function _(e){const t=document.getElementById("imageContainer");t.innerHTML="",e.forEach(({thumbnail:n,title:r},a)=>{if(!n)return;const i=document.createElement("img");i.src=n,i.alt=r||`Image ${a+1}`,i.classList.add("thumbnail"),i.addEventListener("click",()=>{const l=document.getElementById("fullscreenOverlay"),s=document.getElementById("fullscreenImage");s.src=n,s.alt=r||`Image ${a+1}`,l.classList.remove("hidden")}),t.appendChild(i)})}document.getElementById("scrollArrow").addEventListener("click",()=>{document.getElementById("imageContainer").scrollBy({left:900,behavior:"smooth"})});document.getElementById("closeFullscreen").addEventListener("click",()=>{document.getElementById("fullscreenOverlay").classList.add("hidden")});function ee(e){if(e.includes("multi;"))return null;const t=C(e);if(t.isValid()){const{r:n,g:r,b:a}=t.toRgb();if(n===0&&r===0&&a===0)return null;const i=30;return n<i&&r<i&&a<i?t.lighten(.2).toHex():t.toHex()}else return console.log("Invalid color input"),null}function ve(e){return e.charAt(0).toUpperCase()+e.slice(1)}
